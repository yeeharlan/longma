<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
	</head>
	<body>
		<button id="export">Export</button>
		<span id="vvv"></span>
		<div id="Loading"></div>

		<script>
			/*@author  Harlan Yee
			 *@date 2018/07/15
			 *@desc php下载Excel大文件页面加载显示效果
			 */
			$("#export").click(function(){
				$.ajax({
					type: "get",
					cache: false,
					url: "/ExportExcel.php",					
					beforeSend: function() {
						uploading();
					},
					success: function(filename) {
						location.href = "/"+filename;
					},
					complete: function(data) {	
						completeUpLoading();				
					}
				})
			})
			//导出中  效果显示
			function uploading() {
				var _PageHeight = document.documentElement.clientHeight,
					_PageWidth = document.documentElement.clientWidth;
				var _LoadingTop = _PageHeight > 61 ? (_PageHeight - 61) / 2 : 0,
					_LoadingLeft = _PageWidth > 215 ? (_PageWidth - 215) / 2 : 0;
				var _LoadingHtml = '<div style="position:fixed;left:0;width:100%;height:' + _PageHeight + 'px;top:0;z-index:99999;"><div style="position: fixed; cursor1: wait; left: ' + _LoadingLeft + 'px; top:' + _LoadingTop + 'px; width: 150px; height: 150px; line-height: 57px; padding-left: 50px; padding-right: 5px; font-family:\'Microsoft YaHei\';"><h1>导出中...</h1></div></div>';
				$("#Loading").html(_LoadingHtml);
				$("#Loading").show();
			}
			function completeUpLoading() {
				$("#Loading").hide();
			}	
		</script>
	</body>

</html>